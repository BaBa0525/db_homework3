import{_ as N,r as I,i as T,a as P,c as v,e as l,o as r,v as n,x as a,f as d,w as i,B as u,g as _,Q as U,R as A,J as M,z as y,K as R,L as q}from"./index.7aec1e25.js";import{B as z}from"./BaseDropDown.e4f132dc.js";import{B as x}from"./BaseTable.557ffc12.js";import{B as E}from"./BaseImage.db582573.js";import{P as J}from"./PopupModal.264a6550.js";var K="/assets/powerman.0dca1475.png";const b=p=>(R("data-v-6d98cee6"),p=p(),q(),p),L={key:0},Q={class:"base-container"},Y=["onUpdate:modelValue"],j=["onClick"],G={class:"button-flex"},H=["onClick"],W=["onClick"],X={class:"button-flex"},Z={class:"totalprice"},ee=b(()=>a("hr",null,null,-1)),te={key:1,class:"container"},se=b(()=>a("h1",null,"You are not a shop owner!",-1)),oe=b(()=>a("img",{src:K},null,-1)),ae=[se,oe],le={name:"ShopOrderView",setup(p){const k=I({status:"All"}),V=["All","Finished","Not finished","Cancelled"],S=[{key:"select",sortable:!1},{key:"OID",sortable:!1},{key:"status",sortable:!1},{key:"startTime",sortable:!1},{key:"endTime",sortable:!1},{key:"shopname",sortable:!1},{key:"total_price",sortable:!1},{key:"detail",sortable:!1},{key:"action",sortable:!1}],c=T([]),m=P(),o=I({active:!1,order:null,orderDetail:[]}),$=async t=>{o.active=!0,o.order=t,await F(),console.log(o.orderDetail)},D=v(()=>c.value.filter(t=>t.checked).length>0),w=async(t=null)=>{try{const s=c.value.filter(e=>e.checked).map(e=>e.OID);await _.post("/cancelorder",{orderIDs:t===null?s:[t.OID]}),await h(),alert("cancel successfully")}catch(s){alert(s.response.data.message)}},h=async()=>{try{const t=await _.post("/getshoporder",{shopname:m.shopname,status:k.status});c.value=t.data;for(const s of c.value)s.checked=!1}catch(t){console.log(t)}};h();const B=[{key:"RID",sortable:!1},{key:"picture",sortable:!1},{key:"mealname",sortable:!1},{key:"price",sortable:!1},{key:"quantity",sortable:!1}],F=async()=>{try{const t=await _.get(`/getorderdetail/${o.order.OID}`);o.orderDetail=t.data,console.log(o.orderDetail)}catch(t){console.log(t)}},g=v(()=>o.order.subtotal),O=v(()=>o.order.deliverFee),C=async(t=null)=>{try{const s=c.value.filter(e=>e.checked).map(e=>e.OID);await _.post("/finishorder",{orderIDs:t===null?s:[t.OID]}),alert("Finish Order Successfully!")}catch(s){alert(s.response.data.message)}await h()};return(t,s)=>l(m).isOwner?(r(),n("div",L,[a("div",Q,[d(z,{modelValue:k.status,"onUpdate:modelValue":s[0]||(s[0]=e=>k.status=e),id:"status",options:V,onChoose:h},null,8,["modelValue"]),d(x,{fields:S,items:c.value},{"cell(select)":i(({item:e})=>[e.status==="Not finished"?U((r(),n("input",{key:0,type:"checkbox","onUpdate:modelValue":f=>e.checked=f},null,8,Y)),[[A,e.checked]]):u("",!0)]),"cell(total_price)":i(({item:e})=>[M(" $"+y(e.subtotal+e.deliverFee),1)]),"cell(detail)":i(({item:e})=>[a("button",{type:"button",onClick:f=>$(e)},"Order Details",8,j)]),"cell(action)":i(({item:e})=>[a("div",G,[e.status==="Not finished"?(r(),n("button",{key:0,type:"button",onClick:f=>C(e)},"Finish",8,H)):u("",!0),e.status==="Not finished"?(r(),n("button",{key:1,type:"button",onClick:f=>w(e)},"Cancel",8,W)):u("",!0)])]),_:1},8,["items"]),a("div",X,[l(D)?(r(),n("button",{key:0,type:"button",onClick:s[1]||(s[1]=e=>C())},"finish")):u("",!0),l(D)?(r(),n("button",{key:1,type:"button",onClick:s[2]||(s[2]=e=>w())},"cancel")):u("",!0)])]),d(J,{show:o.active,titles:"Order",onClosePopup:s[3]||(s[3]=e=>o.active=!1)},{default:i(()=>[d(x,{fields:B,items:o.orderDetail},{"cell(picture)":i(({item:e})=>[d(E,{src:e.image,alt:e.mealname,width:"100",height:"100"},null,8,["src","alt"])]),_:1},8,["items"]),a("div",Z,[a("p",null,"Subtotal $"+y(l(g)),1),a("p",null,"Delivery Fee $"+y(l(O)),1),ee,a("p",null,"Total Price $"+y(l(g)+l(O)),1)])]),_:1},8,["show"])])):(r(),n("div",te,ae))}};var ue=N(le,[["__scopeId","data-v-6d98cee6"]]);export{ue as default};
