import{_ as N,r as w,i as S,a as M,c as k,o as d,v as u,x as l,f as r,w as o,e as n,B as _,F as T,g as m,Q as P,R as U,J as A,z as p,K as q,L as z}from"./index.7aec1e25.js";import{B as E}from"./BaseDropDown.e4f132dc.js";import{B as D}from"./BaseTable.557ffc12.js";import{P as J}from"./PopupModal.264a6550.js";import{B as C}from"./BaseImage.db582573.js";const K=i=>(q("data-v-230ca374"),i=i(),z(),i),L={class:"container"},Q=["onUpdate:modelValue"],R=["onClick"],j=["onClick"],G={class:"totalprice"},H=K(()=>l("hr",null,null,-1)),W={name:"MyOrderView",setup(i){const f=w({status:"All"}),O=["All","Finished","Not finished","Cancelled"],V=[{key:"select",sortable:!1},{key:"OID",sortable:!1},{key:"status",sortable:!1},{key:"startTime",sortable:!1},{key:"endTime",sortable:!1},{key:"shopname",sortable:!1},{key:"total_price",sortable:!1},{key:"detail",sortable:!1},{key:"action",sortable:!1}],c=S([]),x=M(),a=w({active:!1,order:null,orderDetail:[]}),B=async t=>{a.active=!0,a.order=t,console.log(a.order),await F()},I=k(()=>c.value.filter(t=>t.checked).length>0),v=async(t=null)=>{try{const s=c.value.filter(e=>e.checked).map(e=>e.OID);await m.post("/cancelorder",{orderIDs:t===null?s:[t.OID]}),alert("Cancel successfully")}catch(s){alert(s.response.data.message)}await y()},y=async()=>{try{const t=await m.post("/getorder",{account:x.account,status:f.status});c.value=t.data;for(const s of c.value)s.checked=!1}catch(t){console.log(t)}};y();const $=[{key:"picture",sortable:!1},{key:"mealname",sortable:!1},{key:"price",sortable:!1},{key:"quantity",sortable:!1}],F=async()=>{try{const t=await m.get(`/getorderdetail/${a.order.OID}`);a.orderDetail=t.data,console.log(a.orderDetail)}catch(t){console.log(t)}},b=k(()=>a.order.subtotal),g=k(()=>a.order.deliverFee);return(t,s)=>(d(),u(T,null,[l("div",L,[r(E,{modelValue:f.status,"onUpdate:modelValue":s[0]||(s[0]=e=>f.status=e),id:"status",options:O,onChoose:y},null,8,["modelValue"]),r(D,{fields:V,items:c.value},{"cell(select)":o(({item:e})=>[e.status==="Not finished"?P((d(),u("input",{key:0,type:"checkbox","onUpdate:modelValue":h=>e.checked=h},null,8,Q)),[[U,e.checked]]):_("",!0)]),"cell(picture)":o(({item:e})=>[r(C,{src:e.image,alt:e.name,width:"100",height:"100"},null,8,["src","alt"])]),"cell(total_price)":o(({item:e})=>[A(" $"+p(e.subtotal+e.deliverFee),1)]),"cell(detail)":o(({item:e})=>[l("button",{type:"button",onClick:h=>B(e)},"Order Details",8,R)]),"cell(action)":o(({item:e})=>[e.status==="Not finished"?(d(),u("button",{key:0,type:"button",onClick:h=>v(e)},"Cancel",8,j)):_("",!0)]),_:1},8,["items"]),n(I)?(d(),u("button",{key:0,type:"button",onClick:s[1]||(s[1]=e=>v())},"cancel")):_("",!0)]),r(J,{show:a.active,titles:"Order",onClosePopup:s[2]||(s[2]=e=>a.active=!1)},{default:o(()=>[r(D,{fields:$,items:a.orderDetail},{"cell(picture)":o(({item:e})=>[r(C,{src:e.image,alt:e.name,width:"100",height:"100"},null,8,["src","alt"])]),_:1},8,["items"]),l("div",G,[l("p",null,"Subtotal $"+p(n(b)),1),l("p",null,"Delivery Fee $"+p(n(g)),1),H,l("p",null,"Total Price $"+p(n(b)+n(g)),1)])]),_:1},8,["show"])],64))}};var se=N(W,[["__scopeId","data-v-230ca374"]]);export{se as default};
