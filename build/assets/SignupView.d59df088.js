var y=Object.defineProperty;var c=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var h=(l,t,r)=>t in l?y(l,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[t]=r,w=(l,t)=>{for(var r in t||(t={}))x.call(t,r)&&h(l,r,t[r]);if(c)for(var r of c(t))U.call(t,r)&&h(l,r,t[r]);return l};import{u as v,r as A,c as M,o as P,b as S,w as k,d as I,e as o,f as n,g}from"./index.7aec1e25.js";import{u as N,B as u,r as d,b as R,a as m,c as i,s as q,d as $,n as V,e as f}from"./BaseInput.ceb0847e.js";import{B as C}from"./BaseForm.9243d21b.js";const z={name:"SignupView",setup(l){const t=v(),r=A({realname:"",account:"",phone:"",password:"",confirm:"",latitude:"",longitude:""}),B=async()=>{try{return!(await g.get(`check/${r.account}`)).data.exists}catch(p){return console.log(p),!0}},b=M(()=>({realname:{required:d,alpha:R},account:{required:d,alphaNum:m,uniqueAccount:i.withMessage("This account has been registered",i.withAsync(B))},phone:{required:d,phoneFormat:i.withMessage("Invalid phone number",i.regex(/^09\d{8}$/))},password:{required:d,alphaNum:m},confirm:{required:d,alphaNum:m,sameAsPassword:i.withMessage("Please check your password again",q(r.password))},latitude:{required:d,possibleValue:i.withMessage("Invalid latitude",$(V,f(-90,90)))},longitude:{required:d,possibleValue:i.withMessage("Invalid longitude",$(V,f(-180,180)))}})),e=N(b,r),E=async()=>{if(e.value.$touch(),e.value.$error){r.password=r.confirm="";return}try{await g.post("/register",w({},r)),alert("Registration succeed!"),t.push({name:"signin"})}catch(p){alert("Registration failed!"),console.log(p),r.password=r.confirm=""}};return(p,a)=>(P(),S(C,{onSubmit:I(E,["prevent"]),buttonText:"Sign Up",disableButton:o(e).$error||o(e).$errors.length>0},{default:k(()=>[n(u,{modelValue:r.realname,"onUpdate:modelValue":a[0]||(a[0]=s=>r.realname=s),placeholder:"Real Name",hasError:o(e).realname.$error,errors:o(e).realname.$errors,id:"realname",type:"text",onBlur:o(e).realname.$touch},null,8,["modelValue","hasError","errors","onBlur"]),n(u,{modelValue:r.account,"onUpdate:modelValue":a[1]||(a[1]=s=>r.account=s),placeholder:"Account",hasError:o(e).account.$error,errors:o(e).account.$errors,id:"account",type:"text",onBlur:o(e).account.$touch},null,8,["modelValue","hasError","errors","onBlur"]),n(u,{modelValue:r.phone,"onUpdate:modelValue":a[2]||(a[2]=s=>r.phone=s),placeholder:"Phone Number",hasError:o(e).phone.$error,errors:o(e).phone.$errors,id:"phone",type:"text",onBlur:o(e).phone.$touch},null,8,["modelValue","hasError","errors","onBlur"]),n(u,{modelValue:r.password,"onUpdate:modelValue":a[3]||(a[3]=s=>r.password=s),placeholder:"Password",hasError:o(e).password.$error,errors:o(e).password.$errors,id:"password",type:"password",onBlur:o(e).password.$touch},null,8,["modelValue","hasError","errors","onBlur"]),n(u,{modelValue:r.confirm,"onUpdate:modelValue":a[4]||(a[4]=s=>r.confirm=s),placeholder:"Confirm Password",hasError:o(e).confirm.$error,errors:o(e).confirm.$errors,id:"confirm",type:"password",onBlur:o(e).confirm.$touch},null,8,["modelValue","hasError","errors","onBlur"]),n(u,{modelValue:r.latitude,"onUpdate:modelValue":a[5]||(a[5]=s=>r.latitude=s),placeholder:"Latitude",hasError:o(e).latitude.$error,errors:o(e).latitude.$errors,id:"latitude",type:"text",onBlur:o(e).latitude.$touch},null,8,["modelValue","hasError","errors","onBlur"]),n(u,{modelValue:r.longitude,"onUpdate:modelValue":a[6]||(a[6]=s=>r.longitude=s),placeholder:"Longitude",hasError:o(e).longitude.$error,errors:o(e).longitude.$errors,id:"longitude",type:"text",onBlur:o(e).longitude.$touch},null,8,["modelValue","hasError","errors","onBlur"])]),_:1},8,["onSubmit","disableButton"]))}};export{z as default};
